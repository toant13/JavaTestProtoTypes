package com.test.client;

import java.io.File;
import java.net.URI;

import javax.ws.rs.client.Client;
import javax.ws.rs.client.ClientBuilder;
import javax.ws.rs.client.Entity;
import javax.ws.rs.client.WebTarget;
import javax.ws.rs.core.MediaType;
import javax.ws.rs.core.UriBuilder;

import org.glassfish.jersey.client.ClientConfig;
import org.glassfish.jersey.media.multipart.FormDataMultiPart;
import org.glassfish.jersey.media.multipart.MultiPart;
import org.glassfish.jersey.media.multipart.MultiPartFeature;
import org.glassfish.jersey.media.multipart.file.FileDataBodyPart;

public class ClientJersey2 {

	
	public static void main(String[] args) {
		System.out.println("starting");
		ClientJersey2 cj = new ClientJersey2();
		cj.getTest();
		cj.save();
	}
	
	
	public void getTest()
	{
		
		Client client = ClientBuilder.newClient();
		
		WebTarget target = client.target(getBaseURI());
		String result = target.path("myresource").request().get(String.class);
		System.out.println(result);
		
		
		
	}
	
	
	public void save()
	{
		Client client = ClientBuilder.newClient().register(MultiPartFeature.class);	
		WebTarget target = client.target(getBaseURI());
		
		File data = new File("/Users/toantran/Documents/Java_development/workspace/JerseyTest/src/main/resources/input/input.xml");
        FileDataBodyPart fileDataBodyPart = new FileDataBodyPart("file", data, MediaType.APPLICATION_OCTET_STREAM_TYPE);
        MultiPart entity = new FormDataMultiPart().bodyPart(fileDataBodyPart);
        String response = target.path("myresource").path("save").request().post(Entity.entity(entity, MediaType.MULTIPART_FORM_DATA_TYPE), String.class);
        System.out.println(response);
	}
	
	public void getFile()
	{
		
	}
	
	
	
	private URI getBaseURI()
	{
		return UriBuilder.fromUri("http://localhost:8080/").build();
	}
	
	
	
}
